# xv6-riscv README

## Overview

xv6 is a modern re-implementation of Dennis Ritchie and Ken Thompson's **Unix Version 6 (v6)**. It follows the original structure and design philosophy of v6 but is re-written in **ANSI C** for the **RISC-V multiprocessor architecture**. xv6 is widely used as an educational operating system in MITâ€™s 6.1810 Operating Systems course.

This customized version extends the base xv6 with **semaphore synchronization primitives** and includes demonstration programs to verify inter-process communication and synchronization.

---

## New Features in This Project

### Semaphore System Calls

Newly implemented system calls for process synchronization:

| System Call           | Description                                 |
| --------------------- | ------------------------------------------- |
| `sem_init(int value)` | Initialize a semaphore with a given count   |
| `sem_wait(int id)`    | Wait (decrement), block if value <= 0       |
| `sem_post(int id)`    | Signal (increment), wake up waiting process |
| `sem_free(int id)`    | Free a semaphore and release resources      |

* Implemented in: `kernel/semaphore.c`
* Kernel linkage through: `sysproc.c`, `syscall.c`, `syscall.h`
* User-level interface: `user/semtest.c`, `user/prodcons.c`

---

## Demonstration Programs

### 1. **semtest.c**

A simple parent-child synchronization test:

* The child waits using `sem_wait()`.
* The parent releases it using `sem_post()`.

Expected Output:

```
Parent: waiting on semaphore...
Child: semaphore acquired!
```

### 2. **prodcons.c**

Implements the **Producer-Consumer problem** using semaphores:

* Ensures mutual exclusion and synchronization.
* Demonstrates inter-process communication.

Expected Output:

```
Producer: produced item 1
Consumer: consumed item 1
Producer finished!
Consumer finished!
All items processed!
```

---

## xv6 System Architecture Summary

For detailed system design and subsystem descriptions, refer to the accompanying documentation:
ðŸ“„ `System_Architecture.md`

Covers:

* Boot and initialization sequence
* Process scheduling (Round Robin)
* Memory management (Sv39 paging)
* File system structure (inode + journaling)
* System call mechanism and semaphore synchronization

---

## Build and Run Instructions

### 1. Install Dependencies (macOS / Linux)

```bash
brew install qemu riscv-tools
```

### 2. Build xv6 for RISC-V

```bash
make TOOLPREFIX=riscv64-unknown-elf-
```

### 3. Run xv6 in QEMU

```bash
make qemu TOOLPREFIX=riscv64-unknown-elf-
```

### 4. Inside xv6 Shell

To run demo programs:

```bash
$ semtest
$ prodcons
```

---

## Acknowledgments

xv6 is based on the work of:

* Dennis Ritchie and Ken Thompson (original Unix v6)
* MIT CSAIL PDOS group: Russ Cox, Frans Kaashoek, and Robert Morris

See the original xv6 distribution and documentation at:
[https://pdos.csail.mit.edu/6.1810/](https://pdos.csail.mit.edu/6.1810/)

---

## Author

**Kaidi Lyu, Sessoms, Carson**
University of South Carolina
*Operating Systems Project â€” xv6 Semaphore Extension*
